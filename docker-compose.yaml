services:
  redis:
    image: redis:7-alpine
    restart: always
    ports:
      - "6379:6379"
  livekit-server:
    image: livekit/livekit-server:latest
    restart: always
    depends_on:
      - redis
    ports:
      - "7880:7880"
      - "7881:7881"
      - "50000-51000:50000-51000/udp"
    volumes:
      - ./config.yaml:/livekit-server.yaml:ro
    command: ["--config", "/livekit-server.yaml"]
  
  sip:
    image: livekit/sip
    network_mode: host
    environment:
      SIP_CONFIG_BODY: |
        api_key: '2cc2651675eaa276761927f0379145f4'
        api_secret: 'WXyAxF8PpnjcjCK6PIZ41Srs8aQ5cLB/vmDOrAPX5eA='
        ws_url: 'ws://192.168.0.103:7880'
        redis:
          address: redis:6379
        sip_port: 5060
        rtp_port: 10000-11000
        use_external_ip: true
        node_ip: "192.168.0.110"
        logging:
          level: debug
volumes:
  redis_data:


  # sip-server:
  #   image: livekit/sip:latest
  #   ports:
  #     - "5060:5060/udp"
  #     - "5060:5060/tcp"
  #     - "10000-11000:10000-11000/udp"
  #   volumes:
  #     - ./sip-config.yaml:/sip/config.yaml
  #   depends_on:
  #     - redis